mission_id: "web_pentest_001"
mission_name: "Web Application Penetration Test"
description: "AI-powered web application security testing with comprehensive vulnerability assessment"

objective_stages:
  - stage_id: "web_discovery"
    description: "ENUMERATE: Web application discovery and mapping"
    tasks:
      - agent_type: "webscan"
        params:
          task_type: "crawl"
          url: "https://target.example.com"
          max_depth: 3
          max_pages: 200
          extract_forms: true
          detect_ajax: true
    success_criteria:
      - "web_endpoints_discovered"
      - "forms_extracted"

  - stage_id: "technology_detection"
    description: "PLAN: Identify technologies and frameworks"
    depends_on: "web_discovery"
    tasks:
      - agent_type: "webscan"
        params:
          task_type: "scan"
          url: "https://target.example.com"
          scan_depth: "quick"
          cve_analysis: true
    success_criteria:
      - "technologies_detected"

  - stage_id: "xss_testing"
    description: "EXECUTE: Cross-site scripting vulnerability testing"
    depends_on: "web_discovery"
    tasks:
      - agent_type: "webscan"
        params:
          task_type: "scan"
          url: "https://target.example.com"
          scan_depth: "deep"
          test_categories: ["xss"]
    success_criteria:
      - "xss_testing_complete"

  - stage_id: "sqli_testing"
    description: "EXECUTE: SQL injection vulnerability testing"
    depends_on: "web_discovery"
    tasks:
      - agent_type: "webscan"
        params:
          task_type: "scan"
          url: "https://target.example.com"
          scan_depth: "deep"
          test_categories: ["sqli"]
    success_criteria:
      - "sqli_testing_complete"

  - stage_id: "ssrf_testing"
    description: "EXECUTE: Server-side request forgery testing"
    depends_on: "web_discovery"
    tasks:
      - agent_type: "webscan"
        params:
          task_type: "scan"
          url: "https://target.example.com"
          scan_depth: "deep"
          test_categories: ["ssrf"]
    success_criteria:
      - "ssrf_testing_complete"

  - stage_id: "comprehensive_fuzzing"
    description: "EXECUTE: Fuzz all discovered endpoints"
    depends_on: "web_discovery"
    tasks:
      - agent_type: "webscan"
        params:
          task_type: "fuzzing"
          url_from_blackboard: "discovered_endpoints"
          parameter: "id"
          payload_type: "xss"
    success_criteria:
      - "fuzzing_complete"

  - stage_id: "api_security_testing"
    description: "EXECUTE: API-specific security testing"
    depends_on: "technology_detection"
    tasks:
      - agent_type: "apimapper"
        params:
          target_host: "target.example.com"
          target_port: 443
      - agent_type: "authtest"
        params_from_blackboard:
          endpoints: "discovered_endpoints"
    success_criteria:
      - "api_security_tested"

overall_success_condition: "Complete web application security assessment with AI-powered vulnerability detection and comprehensive reporting"
